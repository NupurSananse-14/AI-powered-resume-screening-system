{% extends "base.html" %}

{% block title %}Upload Resume - Resume ATS Checker{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <!-- Header -->
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3">
                <i class="fas fa-upload text-primary me-3"></i>Resume ATS Checker
            </h1>
            <p class="lead text-muted">
                Upload your resume and job description to check ATS compatibility and match score
            </p>
        </div>

        <!-- Upload Form -->
        <div class="card shadow-sm">
            <div class="card-body p-5">
                <form action="{{ url_for('upload_file') }}" method="POST" enctype="multipart/form-data" id="uploadForm">
                    <!-- Resume Upload -->
                    <div class="mb-4">
                        <label for="resume" class="form-label h5">
                            <i class="fas fa-file-upload me-2 text-primary"></i>Upload Your Resume
                        </label>
                        <div class="input-group">
                            <input type="file" class="form-control form-control-lg" id="resume" name="resume"
                                accept=".pdf,.docx,.doc" required>
                            <span class="input-group-text">
                                <i class="fas fa-paperclip"></i>
                            </span>
                        </div>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            Supported formats: PDF, DOCX, DOC (Max size: 16MB)
                        </div>
                    </div>

                    <!-- File Info Display -->
                    <div id="fileInfo" class="alert alert-info d-none mb-4">
                        <i class="fas fa-file-alt me-2"></i>
                        <span id="fileName"></span>
                        <small class="d-block mt-1" id="fileSize"></small>
                    </div>

                    <!-- Job Description -->
                    <div class="mb-4">
                        <label for="job_description" class="form-label h5">
                            <i class="fas fa-briefcase me-2 text-primary"></i>Job Description
                        </label>
                        <textarea class="form-control" id="job_description" name="job_description" rows="8"
                            placeholder="Paste the job description here...&#10;&#10;Include required skills, qualifications, and responsibilities to get an accurate match score."
                            required></textarea>
                        <div class="form-text">
                            <i class="fas fa-lightbulb me-1"></i>
                            Include skills, qualifications, and key requirements for better matching
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                            <i class="fas fa-search me-2"></i>Analyze Resume
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Features Info -->
        <div class="row mt-5">
            <div class="col-md-6">
                <div class="card border-0 text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-robot fa-3x text-primary mb-3"></i>
                        <h5>ATS Compatibility</h5>
                        <p class="text-muted">Check if your resume passes Applicant Tracking Systems</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-chart-bar fa-3x text-primary mb-3"></i>
                        <h5>Match Score</h5>
                        <p class="text-muted">See how well your resume matches the job requirements</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // File upload handling
    document.getElementById('resume').addEventListener('change', function (e) {
        const file = e.target.files[0];
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');

        if (file) {
            // Show file info
            fileName.textContent = file.name;
            fileSize.textContent = `Size: ${(file.size / 1024 / 1024).toFixed(2)} MB`;
            fileInfo.classList.remove('d-none');

            // Validate file size (16MB limit)
            if (file.size > 16 * 1024 * 1024) {
                fileInfo.classList.remove('alert-info');
                fileInfo.classList.add('alert-danger');
                fileName.textContent = 'File too large (max 16MB)';
                fileSize.textContent = '';
            } else {
                fileInfo.classList.remove('alert-danger');
                fileInfo.classList.add('alert-info');
            }
        } else {
            fileInfo.classList.add('d-none');
        }
    });

    // Form submission handling
    document.getElementById('uploadForm').addEventListener('submit', function (e) {
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
        submitBtn.disabled = true;
    });
</script>
{% endblock %}